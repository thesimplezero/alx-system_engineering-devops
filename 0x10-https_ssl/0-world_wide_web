#!/usr/bin/env bash
# Usage info
usage() {
  echo "Usage: $0 <domain> [subdomain]" 
  echo "Displays DNS record info for subdomains of given domain"
  exit 1
}

# Check domain argument provided
if [ $# -eq 0 ]; then
  usage
fi

# Set domain 
domain=$1

# Function to display subdomain info
display_record() {
  subdomain=$1
  
  # Lookup IP for subdomain  
  ip=$(dig +short ${subdomain}.${domain} | awk '{print $1}')
  
  # Lookup record type 
  type=$(dig ${subdomain}.${domain} +noall +answer | awk '{print $4}')

  # Print output
  echo "The subdomain ${subdomain} is a ${type} record and points to ${ip}"
}

# If only domain provided, loop through standard subdomains
if [ $# -eq 1 ]; then
  display_record www
  display_record lb-01
  display_record web-01
  display_record web-02

# If subdomain provided, display for just that  
else
  subdomain=$2
  display_record $subdomain
fi